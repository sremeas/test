<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Soil pH and Nutrient Availability Chart</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* Tailwind gray-50 */
        }
        .chart-bar-inner {
            transition: height 0.3s ease-in-out;
        }
        /* Custom scrollbar for a cleaner look */
        .horizontal-scrollbar::-webkit-scrollbar {
            height: 8px;
        }
        .horizontal-scrollbar::-webkit-scrollbar-track {
            background: #f1f5f9; /* gray-100 */
            border-radius: 10px;
        }
        .horizontal-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1; /* gray-300 */
            border-radius: 10px;
        }
        .horizontal-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; /* gray-400 */
        }

        /* --- Custom Styles for a Larger Slider --- */
        #ph-slider {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 12px;
            background: #e2e8f0;
            border-radius: 9999px;
            outline: none;
            opacity: 0.9;
            transition: opacity .2s;
        }

        #ph-slider:hover {
            opacity: 1;
        }

        #ph-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 28px;
            height: 28px;
            background: #4f46e5;
            cursor: pointer;
            border-radius: 50%;
            border: 4px solid white;
            box-shadow: 0 0 5px rgba(0,0,0,0.2);
        }

        #ph-slider::-moz-range-thumb {
            width: 28px;
            height: 28px;
            background: #4f46e5;
            cursor: pointer;
            border-radius: 50%;
            border: 4px solid white;
            box-shadow: 0 0 5px rgba(0,0,0,0.2);
        }

        /* Styles for the orientation overlay */
        #orientation-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.95);
            z-index: 50;
            display: none; /* Hidden by default */
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        /* Simple animation for the rotation icon */
        @keyframes rotate-icon {
            0% { transform: rotate(0deg); }
            50% { transform: rotate(-90deg); }
            100% { transform: rotate(-90deg); }
        }
        .rotate-animation {
            animation: rotate-icon 2.5s infinite ease-in-out;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center p-2 sm:p-4">

    <!-- Orientation Overlay -->
    <div id="orientation-overlay">
        <div class="flex flex-col items-center">
             <!-- SVG Icon for rotation -->
            <svg class="w-16 h-16 text-indigo-500 mb-4 rotate-animation" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 1.5H8.25A2.25 2.25 0 006 3.75v16.5a2.25 2.25 0 002.25 2.25h7.5A2.25 2.25 0 0018 20.25V3.75a2.25 2.25 0 00-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 12c-2.483 0-4.5 2.017-4.5 4.5s2.017 4.5 4.5 4.5 4.5-2.017 4.5-4.5-2.017-4.5-4.5-4.5zm0 0V7.5m0 4.5H15" />
            </svg>
            <h2 class="text-xl font-bold text-gray-800">Please Rotate Your Device</h2>
            <p class="text-gray-600 mt-2">For the best experience, please view this chart in landscape mode.</p>
        </div>
    </div>

    <div id="app-content" class="w-full max-w-6xl bg-white p-4 sm:p-6 rounded-2xl shadow-lg">
        
        <!-- Header -->
        <div class="text-center mb-6">
            <h1 class="text-xl sm:text-2xl font-bold text-gray-800">Soil pH and Nutrient Availability</h1>
            <p class="text-sm text-gray-500 mt-1">Adjust the pH slider to see how nutrient availability changes.</p>
        </div>

        <!-- pH Slider Controls -->
        <div class="mb-6 p-4 bg-gray-50 rounded-xl">
            <label for="ph-slider" class="block text-base sm:text-lg font-semibold text-gray-700 mb-2">
                Soil pH: <span id="ph-value" class="font-bold text-indigo-600 text-lg sm:text-xl">6.5</span>
            </label>
            <input id="ph-slider" type="range" min="4.0" max="10.0" value="6.5" step="0.1">
            <div class="flex justify-between text-xs text-gray-500 mt-2">
                <span>4.0</span>
                <span>5.0</span>
                <span>6.0</span>
                <span>7.0</span>
                <span>8.0</span>
                <span>9.0</span>
                <span>10.0</span>
            </div>
             <div class="flex justify-between text-xs sm:text-sm font-medium text-gray-600 mt-3 border-t pt-3">
                <span class="w-1/2 text-center text-orange-600">RANGE OF ACIDITY</span>
                <span class="w-1/2 text-center text-blue-600">RANGE OF ALKALINITY</span>
            </div>
        </div>

        <!-- Nutrient Chart Wrapper for horizontal scrolling -->
        <div class="w-full overflow-x-auto horizontal-scrollbar rounded-lg bg-slate-50 p-3">
            <div id="nutrient-chart" class="flex flex-row flex-nowrap items-end min-h-[224px] w-max mx-auto gap-x-3">
                <!-- Nutrient bars will be dynamically inserted here -->
            </div>
        </div>
        
        <!-- Data Sources Section -->
        <div class="mt-4 text-center border-t pt-3">
             <p class="text-xs text-gray-500">
                 Source: <a href="https://www.nrcs.usda.gov/sites/default/files/2022-10/Soil%20PH.pdf" target="_blank" class="text-blue-600 hover:underline">USDA / NRCS - Soil pH</a>
             </p>
        </div>
    </div>

    <script>
        const nutrientData = [
            { name: 'N', color: '#4CAF50', min: 5.8, peakStart: 6.2, peakEnd: 8.2, max: 9.0 },
            { name: 'P', color: '#E91E63', min: 6.0, peakStart: 6.5, peakEnd: 7.2, max: 8.5 },
            { name: 'K', color: '#9C27B0', min: 5.8, peakStart: 6.0, peakEnd: 9.5, max: 10.0 },
            { name: 'S', color: '#3F51B5', min: 5.8, peakStart: 6.0, peakEnd: 9.5, max: 10.0 },
            { name: 'Ca', color: '#2196F3', min: 6.3, peakStart: 6.8, peakEnd: 9.0, max: 9.5 },
            { name: 'Mg', color: '#FF9800', min: 6.3, peakStart: 6.8, peakEnd: 9.0, max: 9.5 },
            { name: 'Fe', color: '#795548', min: 4.0, peakStart: 4.0, peakEnd: 6.0, max: 8.0 },
            { name: 'Mn', color: '#673AB7', min: 4.5, peakStart: 5.0, peakEnd: 6.5, max: 8.0 },
            { name: 'B', color: '#00695C', min: 5.0, peakStart: 5.0, peakEnd: 7.0, max: 8.5 },
            { name: 'Cu', color: '#B71C1C', min: 5.0, peakStart: 5.2, peakEnd: 7.0, max: 8.0 },
            { name: 'Zn', color: '#D84315', min: 5.0, peakStart: 5.2, peakEnd: 7.0, max: 8.0 },
            { name: 'Mo', color: '#00BCD4', min: 6.5, peakStart: 7.0, peakEnd: 9.5, max: 10.0 }
        ];

        const phSlider = document.getElementById('ph-slider');
        const phValueDisplay = document.getElementById('ph-value');
        const chartContainer = document.getElementById('nutrient-chart');
        const orientationOverlay = document.getElementById('orientation-overlay');
        const appContent = document.getElementById('app-content');

        function calculateAvailability(ph, nutrient) {
            const { min, peakStart, peakEnd, max } = nutrient;
            
            if (ph >= peakStart && ph <= peakEnd) return 100;
            if (ph > min && ph < peakStart) return ((ph - min) / (peakStart - min)) * 100;
            if (ph > peakEnd && ph < max) return (1 - ((ph - peakEnd) / (max - peakEnd))) * 100;
            return 0;
        }

        function updateChart() {
            const currentPh = parseFloat(phSlider.value);
            phValueDisplay.textContent = currentPh.toFixed(1);

            document.querySelectorAll('.nutrient-bar').forEach(bar => {
                const nutrientName = bar.dataset.nutrient;
                const nutrient = nutrientData.find(n => n.name === nutrientName);
                if (nutrient) {
                    const availability = calculateAvailability(currentPh, nutrient);
                    const innerBar = bar.querySelector('.chart-bar-inner');
                    innerBar.style.height = `${availability}%`;
                    
                    if (availability < 25) {
                        innerBar.classList.add('opacity-50');
                    } else {
                        innerBar.classList.remove('opacity-50');
                    }
                }
            });
        }
        
        function initializeChart() {
            nutrientData.forEach(nutrient => {
                const barWrapper = document.createElement('div');
                barWrapper.className = 'nutrient-bar text-center flex flex-col items-center';
                barWrapper.dataset.nutrient = nutrient.name;

                const barContainer = document.createElement('div');
                barContainer.className = 'w-8 sm:w-10 h-48 bg-gray-200 rounded-lg flex items-end';
                
                const innerBar = document.createElement('div');
                innerBar.className = 'chart-bar-inner w-full rounded-lg';
                innerBar.style.backgroundColor = nutrient.color;
                
                barContainer.appendChild(innerBar);
                
                const label = document.createElement('p');
                label.className = 'text-base sm:text-lg font-bold text-gray-700 mt-2';
                label.textContent = nutrient.name;

                barWrapper.appendChild(barContainer);
                barWrapper.appendChild(label);
                chartContainer.appendChild(barWrapper);
            });
        }

        // --- Orientation Check Logic ---
        function checkOrientation() {
            // Check if the screen is in portrait mode (height is greater than width)
            const isPortrait = window.innerHeight > window.innerWidth;
            
            if (isPortrait) {
                orientationOverlay.style.display = 'flex';
                appContent.style.display = 'none';
            } else {
                orientationOverlay.style.display = 'none';
                appContent.style.display = 'block';
            }
        }


        phSlider.addEventListener('input', updateChart);

        // Check orientation on load and whenever the window is resized
        window.addEventListener('resize', checkOrientation);
        window.addEventListener('orientationchange', checkOrientation);

        document.addEventListener('DOMContentLoaded', () => {
            initializeChart();
            updateChart();
            checkOrientation(); // Initial check
        });

    </script>

</body>
</html>